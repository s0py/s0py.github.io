library(data.table)
library(ggplot2)
library(ggdist)

data <- data.table(Trump = c(199, 208, 218, 205, 215, 224, 234, 195, 205, 214, 224, 211, 221, 230, 240, 199, 209, 218, 228, 215, 225, 234, 244, 205, 215, 224, 234, 221, 231, 240, 250, 219, 229, 238, 248, 235, 245, 254, 264, 225, 235, 244, 254, 241, 251, 260, 270, 229, 239, 248, 258, 245, 255, 264, 274, 235, 245, 254, 264, 251, 261, 270, 280, 205, 215, 224, 234, 221, 231, 240, 250, 211, 221, 230, 240, 227, 237, 246, 256, 215, 225, 234, 244, 231, 241, 250, 260, 221, 231, 240, 250, 237, 247, 256, 266, 235, 245, 254, 264, 251, 261, 270, 280, 241, 251, 260, 270, 257, 267, 276, 286, 245, 255, 264, 274, 261, 271, 280, 290, 251, 261, 270, 280, 267, 277, 286, 296, 210, 219, 229, 216, 226, 235, 245, 206, 216, 225, 235, 222, 232, 241, 251, 210, 220, 229, 239, 226, 236, 245, 255, 216, 226, 235, 245, 232, 242, 251, 261, 230, 240, 249, 259, 246, 256, 265, 275, 236, 246, 255, 265, 252, 262, 271, 281, 240, 250, 259, 269, 256, 266, 275, 285, 246, 256, 265, 275, 262, 272, 281, 291, 216, 226, 235, 245, 232, 242, 251, 261, 222, 232, 241, 251, 238, 248, 257, 267, 226, 236, 245, 255, 242, 252, 261, 271, 232, 242, 251, 261, 248, 258, 267, 277, 246, 256, 265, 275, 262, 272, 281, 291, 252, 262, 271, 281, 268, 278, 287, 297, 256, 266, 275, 285, 272, 282, 291, 301, 262, 272, 281, 291, 278, 288, 297, 307))
data$Biden <- 538 - data$Trump
data$category <- fifelse(data$Biden > 270, "Biden Win", "Trump Win")
data$Likelihood <- c(2.22487E-07, 1.53711E-06, 7.77585E-07, 1.10732E-06, 5.60162E-07, 3.87003E-06, 1.95775E-06, 3.98283E-06, 2.01481E-06, 1.39199E-05, 7.04171E-06, 1.00277E-05, 5.07276E-06, 3.50466E-05, 1.77292E-05, 1.86059E-07, 9.41223E-08, 6.5027E-07, 3.28955E-07, 4.68446E-07, 2.36975E-07, 1.63721E-06, 8.2822E-07, 1.68493E-06, 8.5236E-07, 5.88876E-06, 2.97897E-06, 4.24219E-06, 2.14602E-06, 1.48263E-05, 7.50026E-06, 5.53981E-06, 2.80245E-06, 1.93615E-05, 9.79447E-06, 1.39478E-05, 7.05581E-06, 4.8747E-05, 2.46599E-05, 5.01678E-05, 2.53786E-05, 0.000175335, 8.86975E-05, 0.000126309, 6.38966E-05, 0.000441447, 0.000223317, 2.3436E-06, 1.18557E-06, 8.1908E-06, 4.14352E-06, 5.90055E-06, 2.98494E-06, 2.06223E-05, 1.04323E-05, 2.12233E-05, 1.07363E-05, 7.41749E-05, 3.75232E-05, 5.34347E-05, 2.70312E-05, 0.000186753, 9.44734E-05, 2.64393E-05, 1.3375E-05, 9.24045E-05, 4.67451E-05, 6.65671E-05, 3.36746E-05, 0.00023265, 0.000117692, 0.000239431, 0.000121122, 0.000836804, 0.000423318, 0.000602823, 0.000304953, 0.002106849, 0.001065801, 1.11851E-05, 5.65823E-06, 3.90914E-05, 1.97753E-05, 2.8161E-05, 1.42459E-05, 9.84218E-05, 4.9789E-05, 0.00010129, 5.12403E-05, 0.000354007, 0.000179083, 0.000255022, 0.000129009, 0.000891296, 0.000450884, 0.000333029, 0.000168471, 0.001163928, 0.000588801, 0.000838479, 0.000424165, 0.00293046, 0.001482444, 0.003015875, 0.001525653, 0.010540392, 0.005332113, 0.007593168, 0.003841188, 0.026537895, 0.013424838, 0.000140887, 7.12711E-05, 0.000492396, 0.00024909, 0.000354716, 0.000179442, 0.001239722, 0.000627143, 0.001275856, 0.000645423, 0.004459079, 0.002255733, 0.003212265, 0.001625002, 0.011226772, 0.005679335, 1.56425E-06, 1.0807E-05, 5.46701E-06, 7.78526E-06, 3.93836E-06, 2.72093E-05, 1.37645E-05, 2.80023E-05, 1.41657E-05, 9.78673E-05, 4.95086E-05, 7.05024E-05, 3.56653E-05, 0.000246404, 0.000124649, 1.30813E-06, 6.61751E-07, 4.57189E-06, 2.3128E-06, 3.29353E-06, 1.66611E-06, 1.15108E-05, 5.82301E-06, 1.18463E-05, 5.99274E-06, 4.14025E-05, 2.09444E-05, 2.98258E-05, 1.50881E-05, 0.00010424, 5.27325E-05, 3.8949E-05, 1.97033E-05, 0.000136126, 6.88625E-05, 9.80632E-05, 4.96077E-05, 0.000342728, 0.000173377, 0.000352718, 0.000178431, 0.001232738, 0.00062361, 0.000888049, 0.000449241, 0.003103705, 0.001570084, 1.64773E-05, 8.33542E-06, 5.75875E-05, 2.91321E-05, 4.14853E-05, 2.09864E-05, 0.00014499, 7.33467E-05, 0.000149216, 7.54846E-05, 0.000521506, 0.000263816, 0.000375686, 0.00019005, 0.001313012, 0.000664219, 0.000185888, 9.4036E-05, 0.000649673, 0.000328653, 0.000468017, 0.000236758, 0.001635704, 0.000827461, 0.00168338, 0.000851579, 0.005883363, 0.002976242, 0.004238302, 0.002144048, 0.014812738, 0.007493383, 7.86394E-05, 3.97816E-05, 0.000274842, 0.000139036, 0.000197993, 0.00010016, 0.000691979, 0.000350055, 0.000712149, 0.000360258, 0.002488938, 0.00125909, 0.001793, 0.000907032, 0.006266481, 0.003170052, 0.002341448, 0.001184478, 0.008183292, 0.004139717, 0.005895142, 0.0029822, 0.020603345, 0.010422702, 0.021203873, 0.010726494, 0.074106905, 0.037488776, 0.053385694, 0.027006448, 0.186581411, 0.094386733, 0.000990542, 0.00050109, 0.003461915, 0.001751294, 0.002493921, 0.00126161, 0.008716179, 0.004409291, 0.008970231, 0.004537809, 0.031350689, 0.015859507, 0.022584647, 0.011424991, 0.078932669, 0.039930005)

  
  
dt <- dcast(data, Biden~., sum, value.var = "Likelihood")
colnames(dt) <- c("Biden Electoral Votes", "Relative Likelihood")
dt$`Relative Likelihood` <- dt$`Relative Likelihood`
dt$category <- fifelse(dt$`Biden Electoral Votes` > 270, "Biden Win", "Trump Win")

ggplot(dt, aes(x=`Biden Electoral Votes`, y=`Relative Likelihood`, fill=category))+
  geom_col()+
  scale_fill_manual(values=c(
    "Trump Win"="#ee4444",
    "Biden Win"="#0077ee"
  ))+
  #geom_vline(xintercept = as.numeric(data[order(-density)][1,1]), linetype="dotted", color="#666666", size=1)+
  theme_bw()+
  theme(legend.position = "bottom")+
  scale_x_continuous(breaks=seq(0,400,5),expand = c(0,0), limits=c(min(dt$`Biden Electoral Votes`),max(dt$`Biden Electoral Votes`)))+
  scale_y_continuous(expand=c(0,0), limits=c(0,0.25))+
  theme(axis.line = element_line(color='black'),
        plot.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank())

ggsave("electoral college 2023-11-22.png")
