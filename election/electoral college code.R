library(data.table)
library(ggplot2)
library(ggdist)

data <- data.table(Trump = c(199, 208, 218, 205, 215, 224, 234, 195, 205, 214, 224, 211, 221, 230, 240, 199, 209, 218, 228, 215, 225, 234, 244, 205, 215, 224, 234, 221, 231, 240, 250, 219, 229, 238, 248, 235, 245, 254, 264, 225, 235, 244, 254, 241, 251, 260, 270, 229, 239, 248, 258, 245, 255, 264, 274, 235, 245, 254, 264, 251, 261, 270, 280, 205, 215, 224, 234, 221, 231, 240, 250, 211, 221, 230, 240, 227, 237, 246, 256, 215, 225, 234, 244, 231, 241, 250, 260, 221, 231, 240, 250, 237, 247, 256, 266, 235, 245, 254, 264, 251, 261, 270, 280, 241, 251, 260, 270, 257, 267, 276, 286, 245, 255, 264, 274, 261, 271, 280, 290, 251, 261, 270, 280, 267, 277, 286, 296, 210, 219, 229, 216, 226, 235, 245, 206, 216, 225, 235, 222, 232, 241, 251, 210, 220, 229, 239, 226, 236, 245, 255, 216, 226, 235, 245, 232, 242, 251, 261, 230, 240, 249, 259, 246, 256, 265, 275, 236, 246, 255, 265, 252, 262, 271, 281, 240, 250, 259, 269, 256, 266, 275, 285, 246, 256, 265, 275, 262, 272, 281, 291, 216, 226, 235, 245, 232, 242, 251, 261, 222, 232, 241, 251, 238, 248, 257, 267, 226, 236, 245, 255, 242, 252, 261, 271, 232, 242, 251, 261, 248, 258, 267, 277, 246, 256, 265, 275, 262, 272, 281, 291, 252, 262, 271, 281, 268, 278, 287, 297, 256, 266, 275, 285, 272, 282, 291, 301, 262, 272, 281, 291, 278, 288, 297, 307))
data$Biden <- 538 - data$Trump
data$category <- fifelse(data$Biden > 270, "Biden Win", "Trump Win")
data$Likelihood <- c(6.76526E-09, 7.67395E-08, 8.13386E-08, 3.76531E-07, 3.99097E-07, 4.52702E-06, 4.79833E-06, 5.18103E-08, 5.49153E-08, 6.22914E-07, 6.60246E-07, 3.05639E-06, 3.23957E-06, 3.6747E-05, 3.89493E-05, 3.22777E-08, 3.42122E-08, 3.88075E-07, 4.11333E-07, 1.90413E-06, 2.01825E-06, 2.28933E-05, 2.42654E-05, 2.62007E-07, 2.77709E-07, 3.1501E-06, 3.33889E-06, 1.54563E-05, 1.63826E-05, 0.000185831, 0.000196968, 4.94569E-08, 5.24209E-08, 5.94619E-07, 6.30256E-07, 2.91756E-06, 3.09242E-06, 3.50778E-05, 3.71801E-05, 4.01454E-07, 4.25514E-07, 4.82667E-06, 5.11594E-06, 2.36826E-05, 2.51019E-05, 0.000284735, 0.0003018, 2.50105E-07, 2.65095E-07, 3.00701E-06, 3.18723E-06, 1.47542E-05, 1.56385E-05, 0.00017739, 0.000188021, 2.03017E-06, 2.15184E-06, 2.44087E-05, 2.58715E-05, 0.000119764, 0.000126942, 0.001439918, 0.001526215, 1.15475E-07, 1.22396E-07, 1.38835E-06, 1.47156E-06, 6.81211E-06, 7.22037E-06, 8.19018E-05, 8.68103E-05, 9.37339E-07, 9.93515E-07, 1.12696E-05, 1.1945E-05, 5.52956E-05, 5.86095E-05, 0.000664817, 0.000704661, 5.83961E-07, 6.18959E-07, 7.02095E-06, 7.44173E-06, 3.44491E-05, 3.65137E-05, 0.000414181, 0.000439003, 4.74016E-06, 5.02425E-06, 5.69908E-05, 6.04064E-05, 0.000279632, 0.000296391, 0.003362008, 0.003563499, 8.94762E-07, 9.48387E-07, 1.07577E-05, 1.14024E-05, 5.27839E-05, 5.59473E-05, 0.000634619, 0.000672653, 7.26301E-06, 7.6983E-06, 8.7323E-05, 9.25565E-05, 0.00042846, 0.000454139, 0.005151366, 0.005460097, 4.52485E-06, 4.79603E-06, 5.44021E-05, 5.76626E-05, 0.00026693, 0.000282928, 0.003209296, 0.003401635, 3.67293E-05, 3.89306E-05, 0.000441596, 0.000468062, 0.002166739, 0.002296596, 0.026050661, 0.027611927, 6.46375E-08, 7.33193E-07, 7.77135E-07, 3.59749E-06, 3.8131E-06, 4.32526E-05, 4.58448E-05, 4.95012E-07, 5.24679E-07, 5.95151E-06, 6.3082E-06, 2.92018E-05, 3.09519E-05, 0.000351092, 0.000372134, 3.08392E-07, 3.26874E-07, 3.70779E-06, 3.93E-06, 1.81927E-05, 1.9283E-05, 0.00021873, 0.000231839, 2.50329E-06, 2.65332E-06, 3.0097E-05, 3.19008E-05, 0.000147674, 0.000156525, 0.001775487, 0.001881895, 4.72527E-07, 5.00846E-07, 5.68118E-06, 6.02166E-06, 2.78753E-05, 2.9546E-05, 0.000335145, 0.00035523, 3.83562E-06, 4.06549E-06, 4.61156E-05, 4.88793E-05, 0.000226271, 0.000239832, 0.002720452, 0.002883494, 2.38959E-06, 2.5328E-06, 2.87299E-05, 3.04518E-05, 0.000140967, 0.000149415, 0.001694839, 0.001796414, 1.93969E-05, 2.05594E-05, 0.000233208, 0.000247185, 0.001144262, 0.00121284, 0.013757434, 0.014581944, 1.10328E-06, 1.16941E-06, 1.32648E-05, 1.40597E-05, 6.5085E-05, 6.89857E-05, 0.000782516, 0.000829413, 8.95563E-06, 9.49236E-06, 0.000107673, 0.000114126, 0.000528311, 0.000559974, 0.006351876, 0.006732556, 5.57935E-06, 5.91373E-06, 6.70804E-05, 7.11007E-05, 0.000329137, 0.000348863, 0.003957212, 0.004194375, 4.5289E-05, 4.80032E-05, 0.000544508, 0.000577142, 0.002671691, 0.002831811, 0.032121686, 0.0340468, 8.54884E-06, 9.06119E-06, 0.000102783, 0.000108942, 0.000504314, 0.000534538, 0.006063355, 0.006426744, 6.93931E-05, 7.3552E-05, 0.000834312, 0.000884314, 0.004093643, 0.004338983, 0.049217781, 0.052167496, 4.32318E-05, 4.58228E-05, 0.000519775, 0.000550926, 0.002550335, 0.002703182, 0.030662626, 0.032500295, 0.000350924, 0.000371955, 0.004219147, 0.004472009, 0.020701714, 0.021942407, 0.248896251, 0.263813076)
  
  
dt <- dcast(data, Biden~., sum, value.var = "Likelihood")
colnames(dt) <- c("Biden Electoral Votes", "Relative Likelihood")
dt$`Relative Likelihood` <- dt$`Relative Likelihood`
dt$category <- fifelse(dt$`Biden Electoral Votes` > 270, "Biden Win", "Trump Win")

ggplot(dt, aes(x=`Biden Electoral Votes`, y=`Relative Likelihood`, fill=category))+
  geom_col()+
  scale_fill_manual(values=c(
    "Trump Win"="#ee4444",
    "Biden Win"="#0077ee"
  ))+
  #geom_vline(xintercept = as.numeric(data[order(-density)][1,1]), linetype="dotted", color="#666666", size=1)+
  theme_bw()+
  theme(legend.position = "bottom")+
  scale_x_continuous(breaks=seq(0,400,5),expand = c(0,0), limits=c(min(dt$`Biden Electoral Votes`),max(dt$`Biden Electoral Votes`)))+
  scale_y_continuous(expand=c(0,0), limits=c(0,0.25))+
  theme(axis.line = element_line(color='black'),
        plot.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank())

date <- Sys.Date()
ggsave(paste0("electoral college ", date, ".png"))
