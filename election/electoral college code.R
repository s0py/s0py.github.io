library(data.table)
library(ggplot2)
library(ggdist)

data <- data.table(Trump = c(199, 208, 218, 205, 215, 224, 234, 195, 205, 214, 224, 211, 221, 230, 240, 199, 209, 218, 228, 215, 225, 234, 244, 205, 215, 224, 234, 221, 231, 240, 250, 219, 229, 238, 248, 235, 245, 254, 264, 225, 235, 244, 254, 241, 251, 260, 270, 229, 239, 248, 258, 245, 255, 264, 274, 235, 245, 254, 264, 251, 261, 270, 280, 205, 215, 224, 234, 221, 231, 240, 250, 211, 221, 230, 240, 227, 237, 246, 256, 215, 225, 234, 244, 231, 241, 250, 260, 221, 231, 240, 250, 237, 247, 256, 266, 235, 245, 254, 264, 251, 261, 270, 280, 241, 251, 260, 270, 257, 267, 276, 286, 245, 255, 264, 274, 261, 271, 280, 290, 251, 261, 270, 280, 267, 277, 286, 296, 210, 219, 229, 216, 226, 235, 245, 206, 216, 225, 235, 222, 232, 241, 251, 210, 220, 229, 239, 226, 236, 245, 255, 216, 226, 235, 245, 232, 242, 251, 261, 230, 240, 249, 259, 246, 256, 265, 275, 236, 246, 255, 265, 252, 262, 271, 281, 240, 250, 259, 269, 256, 266, 275, 285, 246, 256, 265, 275, 262, 272, 281, 291, 216, 226, 235, 245, 232, 242, 251, 261, 222, 232, 241, 251, 238, 248, 257, 267, 226, 236, 245, 255, 242, 252, 261, 271, 232, 242, 251, 261, 248, 258, 267, 277, 246, 256, 265, 275, 262, 272, 281, 291, 252, 262, 271, 281, 268, 278, 287, 297, 256, 266, 275, 285, 272, 282, 291, 301, 262, 272, 281, 291, 278, 288, 297, 307))
data$Biden <- 538 - data$Trump
data$category <- fifelse(data$Biden > 270, "Biden Win", "Trump Win")
data$Likelihood <- c(2.93776E-08, 8.42371E-09, 6.24408E-08, 1.18599E-07, 8.7912E-07, 2.52078E-07, 1.86853E-06, 2.31714E-08, 1.71758E-07, 4.92498E-08, 3.65065E-07, 6.934E-07, 5.13984E-06, 1.47379E-06, 1.09245E-05, 1.48302E-08, 1.09929E-07, 3.15209E-08, 2.33649E-07, 4.43791E-07, 3.28961E-06, 9.43259E-07, 6.99192E-06, 8.67058E-08, 6.42708E-07, 1.84289E-07, 1.36605E-06, 2.59466E-06, 1.92329E-05, 5.51483E-06, 4.08787E-05, 9.69337E-08, 7.18522E-07, 2.06028E-07, 1.52719E-06, 2.90073E-06, 2.15017E-05, 6.16537E-06, 4.57009E-05, 5.6673E-07, 4.20089E-06, 1.20456E-06, 8.92881E-06, 1.69593E-05, 0.000125711, 3.60462E-05, 0.000267193, 3.62719E-07, 2.68866E-06, 7.70944E-07, 5.71463E-06, 1.08543E-05, 8.04578E-05, 2.30704E-05, 0.00017101, 2.12066E-06, 1.57194E-05, 4.50738E-06, 3.3411E-05, 6.34605E-05, 0.000470402, 0.000134883, 0.000999819, 4.48763E-08, 3.32646E-07, 9.53826E-08, 7.07025E-07, 1.34292E-06, 9.95438E-06, 2.85431E-06, 2.11576E-05, 2.62372E-07, 1.94484E-06, 5.57661E-07, 4.13367E-06, 7.85145E-06, 5.8199E-05, 1.66879E-05, 0.000123699, 1.67924E-07, 1.24474E-06, 3.56915E-07, 2.64564E-06, 5.0251E-06, 3.72486E-05, 1.06806E-05, 7.91703E-05, 9.81779E-07, 7.27745E-06, 2.08673E-06, 1.54679E-05, 2.93796E-05, 0.000217777, 6.2445E-05, 0.000462875, 1.09759E-06, 8.13591E-06, 2.33288E-06, 1.72925E-05, 3.28452E-05, 0.000243466, 6.98111E-05, 0.000517476, 6.41714E-06, 4.75672E-05, 1.36394E-05, 0.000101102, 0.000192032, 0.001423439, 0.000408156, 0.003025459, 4.10711E-06, 3.0444E-05, 8.72949E-06, 6.47075E-05, 0.000122905, 0.000911033, 0.000261229, 0.00193636, 2.40125E-05, 0.000177993, 5.10376E-05, 0.000378317, 0.000718571, 0.005326415, 0.001527291, 0.011321063, 8.65664E-07, 2.48219E-07, 1.83993E-06, 3.49474E-06, 2.59048E-05, 7.42793E-06, 5.50596E-05, 6.82786E-07, 5.06116E-06, 1.45123E-06, 1.07573E-05, 2.04323E-05, 0.000151454, 4.34279E-05, 0.00032191, 4.36998E-07, 3.23925E-06, 9.28821E-07, 6.8849E-06, 1.30771E-05, 9.69342E-05, 2.77948E-05, 0.000206029, 2.55494E-06, 1.89385E-05, 5.43041E-06, 4.0253E-05, 7.64562E-05, 0.000566732, 0.000162504, 0.001204565, 2.85632E-06, 2.11725E-05, 6.07099E-06, 4.50013E-05, 8.5475E-05, 0.000633585, 0.000181673, 0.001346657, 1.66997E-05, 0.000123787, 3.54945E-05, 0.000263103, 0.000499736, 0.003704297, 0.001062166, 0.007873322, 1.06882E-05, 7.92262E-05, 2.27172E-05, 0.000168392, 0.000319842, 0.002370832, 0.00067981, 0.0050391, 6.24891E-05, 0.000463202, 0.000132818, 0.000984515, 0.001869977, 0.013861231, 0.003974555, 0.029461442, 1.32236E-06, 9.80201E-06, 2.81062E-06, 2.08337E-05, 3.95714E-05, 0.000293323, 8.41073E-05, 0.000623446, 7.73126E-06, 5.73081E-05, 1.64325E-05, 0.000121806, 0.000231357, 0.001714936, 0.000491739, 0.003645021, 4.94818E-06, 3.66784E-05, 1.05171E-05, 7.79584E-05, 0.000148073, 0.001097597, 0.000314724, 0.002332894, 2.89299E-05, 0.000214443, 6.14892E-05, 0.000455789, 0.000865722, 0.006417174, 0.001840054, 0.013639424, 3.23425E-05, 0.000239739, 6.87425E-05, 0.000509555, 0.000967843, 0.007174153, 0.002057109, 0.015248349, 0.000189093, 0.001401651, 0.000401908, 0.002979148, 0.005658563, 0.041944174, 0.012027029, 0.089150516, 0.000121023, 0.000897087, 0.00025723, 0.00190672, 0.003621605, 0.026845196, 0.007697564, 0.057058295, 0.000707571, 0.005244883, 0.001503912, 0.01114777, 0.021173961, 0.156952278, 0.045004333, 0.333595231)
  
  
dt <- dcast(data, Biden~., sum, value.var = "Likelihood")
colnames(dt) <- c("Biden Electoral Votes", "Relative Likelihood")
dt$`Relative Likelihood` <- dt$`Relative Likelihood`
dt$category <- fifelse(dt$`Biden Electoral Votes` > 270, "Biden Win", "Trump Win")

ggplot(dt, aes(x=`Biden Electoral Votes`, y=`Relative Likelihood`, fill=category))+
  geom_col()+
  scale_fill_manual(values=c(
    "Trump Win"="#ee4444",
    "Biden Win"="#0077ee"
  ))+
  #geom_vline(xintercept = as.numeric(data[order(-density)][1,1]), linetype="dotted", color="#666666", size=1)+
  theme_bw()+
  theme(legend.position = "bottom")+
  scale_x_continuous(breaks=seq(0,400,5),expand = c(0,0), limits=c(min(dt$`Biden Electoral Votes`),max(dt$`Biden Electoral Votes`)))+
  scale_y_continuous(expand=c(0,0), limits=c(0,0.25))+
  theme(axis.line = element_line(color='black'),
        plot.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank())

ggsave("electoral college 2024-04-29.png")
