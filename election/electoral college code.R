library(data.table)
library(ggplot2)
library(ggdist)

data <- data.table(Trump = c(199, 208, 218, 205, 215, 224, 234, 195, 205, 214, 224, 211, 221, 230, 240, 199, 209, 218, 228, 215, 225, 234, 244, 205, 215, 224, 234, 221, 231, 240, 250, 219, 229, 238, 248, 235, 245, 254, 264, 225, 235, 244, 254, 241, 251, 260, 270, 229, 239, 248, 258, 245, 255, 264, 274, 235, 245, 254, 264, 251, 261, 270, 280, 205, 215, 224, 234, 221, 231, 240, 250, 211, 221, 230, 240, 227, 237, 246, 256, 215, 225, 234, 244, 231, 241, 250, 260, 221, 231, 240, 250, 237, 247, 256, 266, 235, 245, 254, 264, 251, 261, 270, 280, 241, 251, 260, 270, 257, 267, 276, 286, 245, 255, 264, 274, 261, 271, 280, 290, 251, 261, 270, 280, 267, 277, 286, 296, 210, 219, 229, 216, 226, 235, 245, 206, 216, 225, 235, 222, 232, 241, 251, 210, 220, 229, 239, 226, 236, 245, 255, 216, 226, 235, 245, 232, 242, 251, 261, 230, 240, 249, 259, 246, 256, 265, 275, 236, 246, 255, 265, 252, 262, 271, 281, 240, 250, 259, 269, 256, 266, 275, 285, 246, 256, 265, 275, 262, 272, 281, 291, 216, 226, 235, 245, 232, 242, 251, 261, 222, 232, 241, 251, 238, 248, 257, 267, 226, 236, 245, 255, 242, 252, 261, 271, 232, 242, 251, 261, 248, 258, 267, 277, 246, 256, 265, 275, 262, 272, 281, 291, 252, 262, 271, 281, 268, 278, 287, 297, 256, 266, 275, 285, 272, 282, 291, 301, 262, 272, 281, 291, 278, 288, 297, 307))
data$Biden <- 538 - data$Trump
data$category <- fifelse(data$Biden > 270, "Biden Win", "Trump Win")
data$Likelihood <- c(9.56892E-09, 6.17018E-08, 6.4141E-08, 2.09436E-07, 2.17716E-07, 1.40386E-06, 1.45936E-06, 1.1901E-07, 1.23715E-07, 7.97731E-07, 8.29267E-07, 2.70776E-06, 2.81481E-06, 1.81503E-05, 1.88678E-05, 1.16844E-08, 1.21463E-08, 7.83214E-08, 8.14176E-08, 2.65848E-07, 2.76358E-07, 1.782E-06, 1.85244E-06, 1.51066E-07, 1.57038E-07, 1.0126E-06, 1.05263E-06, 3.4371E-06, 3.57298E-06, 2.30391E-05, 2.39499E-05, 1.12094E-07, 1.16525E-07, 7.51371E-07, 7.81075E-07, 2.5504E-06, 2.65122E-06, 1.70955E-05, 1.77713E-05, 1.44924E-06, 1.50653E-06, 9.71433E-06, 1.00984E-05, 3.29736E-05, 3.42772E-05, 0.000221024, 0.000229762, 1.42287E-07, 1.47912E-07, 9.53755E-07, 9.9146E-07, 3.23736E-06, 3.36534E-06, 2.17002E-05, 2.25581E-05, 1.8396E-06, 1.91232E-06, 1.23309E-05, 1.28184E-05, 4.18552E-05, 4.35098E-05, 0.000280558, 0.000291649, 1.08777E-07, 1.13077E-07, 7.29137E-07, 7.57962E-07, 2.47493E-06, 2.57277E-06, 1.65896E-05, 1.72454E-05, 1.40635E-06, 1.46195E-06, 9.42688E-06, 9.79955E-06, 3.19979E-05, 3.32629E-05, 0.000214484, 0.000222963, 1.38076E-07, 1.43535E-07, 9.25533E-07, 9.62122E-07, 3.14156E-06, 3.26576E-06, 2.10581E-05, 2.18906E-05, 1.78516E-06, 1.85573E-06, 1.1966E-05, 1.24391E-05, 4.06167E-05, 4.22223E-05, 0.000272256, 0.000283019, 1.32463E-06, 1.37699E-06, 8.87904E-06, 9.23005E-06, 3.01384E-05, 3.13298E-05, 0.000202019, 0.000210006, 1.71258E-05, 1.78029E-05, 0.000114795, 0.000119334, 0.000389653, 0.000405057, 0.002611868, 0.002715123, 1.68142E-06, 1.74789E-06, 1.12706E-05, 1.17162E-05, 3.82562E-05, 3.97686E-05, 0.000256434, 0.000266571, 2.17387E-05, 2.25981E-05, 0.000145716, 0.000151476, 0.000494608, 0.000514161, 0.003315382, 0.003446449, 5.12225E-07, 3.3029E-06, 3.43348E-06, 1.12111E-05, 1.16543E-05, 7.51489E-05, 7.81197E-05, 6.37061E-06, 6.62246E-06, 4.27026E-05, 4.43908E-05, 0.000144947, 0.000150677, 0.000971586, 0.001009995, 6.25468E-07, 6.50195E-07, 4.19255E-06, 4.35829E-06, 1.42309E-05, 1.47935E-05, 9.53905E-05, 9.91615E-05, 8.08656E-06, 8.40624E-06, 5.42047E-05, 5.63475E-05, 0.000183988, 0.000191262, 0.001233285, 0.00128204, 6.00039E-06, 6.2376E-06, 4.02209E-05, 4.1811E-05, 0.000136523, 0.00014192, 0.000915122, 0.0009513, 7.75779E-05, 8.06448E-05, 0.000520009, 0.000540566, 0.001765081, 0.00183486, 0.01183144, 0.012299172, 7.61661E-06, 7.91772E-06, 5.10546E-05, 5.30729E-05, 0.000173296, 0.000180147, 0.001161613, 0.001207535, 9.84737E-05, 0.000102367, 0.000660075, 0.00068617, 0.002240511, 0.002329085, 0.015018275, 0.015611992, 5.82283E-06, 6.05303E-06, 3.90308E-05, 4.05738E-05, 0.000132483, 0.000137721, 0.000888043, 0.00092315, 7.52823E-05, 7.82584E-05, 0.000504622, 0.000524571, 0.001712851, 0.001780565, 0.011481341, 0.011935232, 7.39123E-06, 7.68343E-06, 4.95439E-05, 5.15025E-05, 0.000168168, 0.000174816, 0.00112724, 0.001171803, 9.55598E-05, 9.93376E-05, 0.000640543, 0.000665866, 0.002174213, 0.002260166, 0.014573875, 0.015150023, 7.09073E-05, 7.37105E-05, 0.000475296, 0.000494086, 0.00161331, 0.001677089, 0.010814107, 0.01124162, 0.000916747, 0.000952989, 0.006145007, 0.006387938, 0.020858173, 0.021682758, 0.139813525, 0.145340763, 9.00064E-05, 9.35646E-05, 0.000603318, 0.000627169, 0.00204786, 0.002128818, 0.01372692, 0.014269586, 0.001163676, 0.001209679, 0.007800184, 0.008108548, 0.026476386, 0.027523075, 0.17747273, 0.184488747)

  
dt <- dcast(data, Biden~., sum, value.var = "Likelihood")
colnames(dt) <- c("Biden Electoral Votes", "Relative Likelihood")
dt$`Relative Likelihood` <- dt$`Relative Likelihood`
dt$category <- fifelse(dt$`Biden Electoral Votes` > 270, "Biden Win", "Trump Win")

ggplot(dt, aes(x=`Biden Electoral Votes`, y=`Relative Likelihood`, fill=category))+
  geom_col()+
  scale_fill_manual(values=c(
    "Trump Win"="#ee4444",
    "Biden Win"="#0077ee"
  ))+
  #geom_vline(xintercept = as.numeric(data[order(-density)][1,1]), linetype="dotted", color="#666666", size=1)+
  theme_bw()+
  theme(legend.position = "bottom")+
  scale_x_continuous(breaks=seq(0,400,5),expand = c(0,0), limits=c(min(dt$`Biden Electoral Votes`),max(dt$`Biden Electoral Votes`)))+
  scale_y_continuous(expand=c(0,0), limits=c(0,0.25))+
  theme(axis.line = element_line(color='black'),
        plot.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank())

date <- Sys.Date()
ggsave(paste0("electoral college ", date, ".png"))
