library(data.table)
library(ggplot2)
library(ggdist)

data <- data.table(Trump = c(199, 208, 218, 205, 215, 224, 234, 195, 205, 214, 224, 211, 221, 230, 240, 199, 209, 218, 228, 215, 225, 234, 244, 205, 215, 224, 234, 221, 231, 240, 250, 219, 229, 238, 248, 235, 245, 254, 264, 225, 235, 244, 254, 241, 251, 260, 270, 229, 239, 248, 258, 245, 255, 264, 274, 235, 245, 254, 264, 251, 261, 270, 280, 205, 215, 224, 234, 221, 231, 240, 250, 211, 221, 230, 240, 227, 237, 246, 256, 215, 225, 234, 244, 231, 241, 250, 260, 221, 231, 240, 250, 237, 247, 256, 266, 235, 245, 254, 264, 251, 261, 270, 280, 241, 251, 260, 270, 257, 267, 276, 286, 245, 255, 264, 274, 261, 271, 280, 290, 251, 261, 270, 280, 267, 277, 286, 296, 210, 219, 229, 216, 226, 235, 245, 206, 216, 225, 235, 222, 232, 241, 251, 210, 220, 229, 239, 226, 236, 245, 255, 216, 226, 235, 245, 232, 242, 251, 261, 230, 240, 249, 259, 246, 256, 265, 275, 236, 246, 255, 265, 252, 262, 271, 281, 240, 250, 259, 269, 256, 266, 275, 285, 246, 256, 265, 275, 262, 272, 281, 291, 216, 226, 235, 245, 232, 242, 251, 261, 222, 232, 241, 251, 238, 248, 257, 267, 226, 236, 245, 255, 242, 252, 261, 271, 232, 242, 251, 261, 248, 258, 267, 277, 246, 256, 265, 275, 262, 272, 281, 291, 252, 262, 271, 281, 268, 278, 287, 297, 256, 266, 275, 285, 272, 282, 291, 301, 262, 272, 281, 291, 278, 288, 297, 307))
data$Biden <- 538 - data$Trump
data$category <- fifelse(data$Biden > 270, "Biden Win", "Trump Win")
data$Likelihood <- c(6.63366E-10, 6.80391E-10, 1.48044E-09, 1.22328E-08, 2.66168E-08, 2.73E-08, 5.94011E-08, 2.0677E-09, 4.49904E-09, 4.61451E-09, 1.00406E-08, 8.29643E-08, 1.80519E-07, 1.85152E-07, 4.02867E-07, 1.49302E-08, 3.2486E-08, 3.33198E-08, 7.24994E-08, 5.99057E-07, 1.30347E-06, 1.33692E-06, 2.90896E-06, 1.01259E-07, 2.20325E-07, 2.2598E-07, 4.91702E-07, 4.06289E-06, 8.84031E-06, 9.0672E-06, 1.9729E-05, 9.80965E-09, 2.13445E-08, 2.18923E-08, 4.76347E-08, 3.93602E-07, 8.56425E-07, 8.78405E-07, 1.91129E-06, 6.65305E-08, 1.44761E-07, 1.48477E-07, 3.23066E-07, 2.66947E-06, 5.8084E-06, 5.95747E-06, 1.29627E-05, 4.80394E-07, 1.04527E-06, 1.0721E-06, 2.33275E-06, 1.92753E-05, 4.19405E-05, 4.30169E-05, 9.35989E-05, 3.2581E-06, 7.08919E-06, 7.27114E-06, 1.5821E-05, 0.000130728, 0.000284446, 0.000291747, 0.000634802, 4.23496E-09, 9.2147E-09, 9.4512E-09, 2.05645E-08, 1.69923E-07, 3.6973E-07, 3.79219E-07, 8.2513E-07, 2.87221E-08, 6.24954E-08, 6.40994E-08, 1.39472E-07, 1.15244E-06, 2.50756E-06, 2.57192E-06, 5.59615E-06, 2.07392E-07, 4.51258E-07, 4.6284E-07, 1.00708E-06, 8.3214E-06, 1.81062E-05, 1.8571E-05, 4.04079E-05, 1.40657E-06, 3.0605E-06, 3.13905E-06, 6.83015E-06, 5.64369E-05, 0.000122799, 0.000125951, 0.000274052, 1.36264E-07, 2.96493E-07, 3.04102E-07, 6.61686E-07, 5.46746E-06, 1.18965E-05, 1.22018E-05, 2.65494E-05, 9.24164E-07, 2.01086E-06, 2.06247E-06, 4.48765E-06, 3.70811E-05, 8.06835E-05, 8.27543E-05, 0.000180062, 6.67307E-06, 1.45197E-05, 1.48924E-05, 3.24038E-05, 0.00026775, 0.000582588, 0.00059754, 0.001300167, 4.52577E-05, 9.84748E-05, 0.000101002, 0.000219767, 0.001815919, 0.003951195, 0.004052604, 0.008817923, 2.61701E-08, 2.68418E-08, 5.84041E-08, 4.82588E-07, 1.05005E-06, 1.077E-06, 2.3434E-06, 8.15719E-08, 1.7749E-07, 1.82045E-07, 3.96105E-07, 3.27299E-06, 7.12158E-06, 7.30436E-06, 1.58933E-05, 5.89003E-07, 1.28159E-06, 1.31448E-06, 2.86014E-06, 2.36331E-05, 5.14225E-05, 5.27422E-05, 0.00011476, 3.9947E-06, 8.69194E-06, 8.91502E-06, 1.93979E-05, 0.000160283, 0.000348755, 0.000357706, 0.000778319, 3.86996E-07, 8.42051E-07, 8.63663E-07, 1.87921E-06, 1.55278E-05, 3.37864E-05, 3.46535E-05, 7.54015E-05, 2.62466E-06, 5.71091E-06, 5.85749E-06, 1.27451E-05, 0.000105312, 0.000229144, 0.000235025, 0.000511384, 1.89518E-05, 4.12365E-05, 4.22949E-05, 9.2028E-05, 0.00076042, 0.001654572, 0.001697038, 0.003692526, 0.000128534, 0.000279672, 0.00028685, 0.000624148, 0.005157282, 0.011221553, 0.011509559, 0.025043255, 1.67071E-07, 3.63525E-07, 3.72855E-07, 8.11282E-07, 6.70355E-06, 1.4586E-05, 1.49604E-05, 3.25518E-05, 1.1331E-06, 2.46548E-06, 2.52875E-06, 5.50223E-06, 4.54645E-05, 9.89246E-05, 0.000101464, 0.000220771, 8.18174E-06, 1.78024E-05, 1.82593E-05, 3.97297E-05, 0.000328283, 0.000714301, 0.000732634, 0.001594112, 5.54897E-05, 0.000120738, 0.000123837, 0.000269453, 0.002226467, 0.004844492, 0.004968828, 0.010811504, 5.37569E-06, 1.16968E-05, 1.1997E-05, 2.61038E-05, 0.000215694, 0.000469321, 0.000481366, 0.001047389, 3.64587E-05, 7.93293E-05, 8.13654E-05, 0.00017704, 0.001462868, 0.003183005, 0.003264698, 0.007103544, 0.000263256, 0.00057281, 0.000587511, 0.001278346, 0.010562869, 0.022983385, 0.023573264, 0.051292257, 0.001785441, 0.003884881, 0.003984588, 0.008669928, 0.071638924, 0.155876681, 0.159877326, 0.347871599)

  
dt <- dcast(data, Biden~., sum, value.var = "Likelihood")
colnames(dt) <- c("Biden Electoral Votes", "Relative Likelihood")
dt$`Relative Likelihood` <- dt$`Relative Likelihood`
dt$category <- fifelse(dt$`Biden Electoral Votes` > 270, "Biden Win", "Trump Win")

ggplot(dt, aes(x=`Biden Electoral Votes`, y=`Relative Likelihood`, fill=category))+
  geom_col()+
  scale_fill_manual(values=c(
    "Trump Win"="#ee4444",
    "Biden Win"="#0077ee"
  ))+
  #geom_vline(xintercept = as.numeric(data[order(-density)][1,1]), linetype="dotted", color="#666666", size=1)+
  theme_bw()+
  theme(legend.position = "bottom")+
  scale_x_continuous(breaks=seq(0,400,5),expand = c(0,0), limits=c(min(dt$`Biden Electoral Votes`),max(dt$`Biden Electoral Votes`)))+
  scale_y_continuous(expand=c(0,0), limits=c(0,0.25))+
  theme(axis.line = element_line(color='black'),
        plot.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank())

ggsave("electoral college 2024-04-27.png")
