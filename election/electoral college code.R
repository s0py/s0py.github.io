library(data.table)
library(ggplot2)
library(ggdist)

data <- data.table(Trump = c(199, 208, 218, 205, 215, 224, 234, 195, 205, 214, 224, 211, 221, 230, 240, 199, 209, 218, 228, 215, 225, 234, 244, 205, 215, 224, 234, 221, 231, 240, 250, 219, 229, 238, 248, 235, 245, 254, 264, 225, 235, 244, 254, 241, 251, 260, 270, 229, 239, 248, 258, 245, 255, 264, 274, 235, 245, 254, 264, 251, 261, 270, 280, 205, 215, 224, 234, 221, 231, 240, 250, 211, 221, 230, 240, 227, 237, 246, 256, 215, 225, 234, 244, 231, 241, 250, 260, 221, 231, 240, 250, 237, 247, 256, 266, 235, 245, 254, 264, 251, 261, 270, 280, 241, 251, 260, 270, 257, 267, 276, 286, 245, 255, 264, 274, 261, 271, 280, 290, 251, 261, 270, 280, 267, 277, 286, 296, 210, 219, 229, 216, 226, 235, 245, 206, 216, 225, 235, 222, 232, 241, 251, 210, 220, 229, 239, 226, 236, 245, 255, 216, 226, 235, 245, 232, 242, 251, 261, 230, 240, 249, 259, 246, 256, 265, 275, 236, 246, 255, 265, 252, 262, 271, 281, 240, 250, 259, 269, 256, 266, 275, 285, 246, 256, 265, 275, 262, 272, 281, 291, 216, 226, 235, 245, 232, 242, 251, 261, 222, 232, 241, 251, 238, 248, 257, 267, 226, 236, 245, 255, 242, 252, 261, 271, 232, 242, 251, 261, 248, 258, 267, 277, 246, 256, 265, 275, 262, 272, 281, 291, 252, 262, 271, 281, 268, 278, 287, 297, 256, 266, 275, 285, 272, 282, 291, 301, 262, 272, 281, 291, 278, 288, 297, 307))
data$Biden <- 538 - data$Trump
data$category <- fifelse(data$Biden > 270, "Biden Win", "Trump Win")
data$Likelihood <- c(5.38759E-10, 1.02823E-09, 4.52201E-09, 8.95589E-09, 3.93868E-08, 7.51703E-08, 3.30589E-07, 1.58777E-09, 6.98282E-09, 1.33268E-08, 5.86096E-08, 1.16077E-07, 5.10491E-07, 9.74278E-07, 4.28475E-06, 8.19359E-10, 3.60344E-09, 6.8772E-09, 3.02451E-08, 5.99006E-08, 2.63435E-07, 5.02769E-07, 2.21111E-06, 1.06197E-08, 4.6704E-08, 8.91351E-08, 3.92005E-07, 7.76369E-07, 3.41437E-06, 6.51637E-06, 2.86581E-05, 1.49971E-09, 6.59555E-09, 1.25877E-08, 5.5359E-08, 1.09639E-07, 4.82179E-07, 9.20244E-07, 4.04711E-06, 1.94377E-08, 8.54846E-08, 1.63148E-07, 7.17505E-07, 1.42103E-06, 6.24949E-06, 1.19272E-05, 5.24544E-05, 1.00307E-08, 4.41137E-08, 8.41916E-08, 3.70264E-07, 7.33311E-07, 3.22501E-06, 6.15496E-06, 2.70687E-05, 1.30007E-07, 5.71756E-07, 1.0912E-06, 4.79897E-06, 9.5044E-06, 4.17991E-05, 7.97742E-05, 0.000350836, 4.28523E-09, 1.88459E-08, 3.59676E-08, 1.58181E-07, 3.13279E-07, 1.37776E-06, 2.62947E-06, 1.15641E-05, 5.55406E-08, 2.4426E-07, 4.66174E-07, 2.05017E-06, 4.06039E-06, 1.78571E-05, 3.40804E-05, 0.000149881, 2.86613E-08, 1.26049E-07, 2.40566E-07, 1.05798E-06, 2.09533E-06, 9.21501E-06, 1.7587E-05, 7.73452E-05, 3.71478E-07, 1.63371E-06, 3.11796E-06, 1.37124E-05, 2.71575E-05, 0.000119435, 0.000227944, 0.001002467, 5.24603E-08, 2.30714E-07, 4.4032E-07, 1.93647E-06, 3.8352E-06, 1.68667E-05, 3.21903E-05, 0.000141569, 6.79935E-07, 2.99027E-06, 5.70696E-06, 2.50985E-05, 4.97078E-05, 0.000218608, 0.000417217, 0.001834865, 3.50876E-07, 1.54311E-06, 2.94504E-06, 1.29519E-05, 2.56513E-05, 0.000112811, 0.000215302, 0.000946869, 4.54768E-06, 2.00001E-05, 3.81705E-05, 0.000167869, 0.000332466, 0.001462141, 0.002790514, 0.012272322, 2.23472E-08, 4.26498E-08, 1.87568E-07, 3.71481E-07, 1.63373E-06, 3.11799E-06, 1.37125E-05, 6.58592E-08, 2.8964E-07, 5.52782E-07, 2.43106E-06, 4.81475E-06, 2.11746E-05, 4.04121E-05, 0.000177727, 3.39862E-08, 1.49467E-07, 2.85259E-07, 1.25453E-06, 2.48462E-06, 1.0927E-05, 2.08544E-05, 9.17147E-05, 4.40493E-07, 1.93723E-06, 3.69723E-06, 1.62599E-05, 3.2203E-05, 0.000141625, 0.000270292, 0.00118871, 6.22066E-08, 2.73577E-07, 5.22124E-07, 2.29624E-06, 4.54772E-06, 2.00003E-05, 3.81708E-05, 0.00016787, 8.06257E-07, 3.54581E-06, 6.76723E-06, 2.97614E-05, 5.89427E-05, 0.000259223, 0.000494729, 0.002175755, 4.16063E-07, 1.82979E-06, 3.49218E-06, 1.53582E-05, 3.0417E-05, 0.00013377, 0.000255302, 0.001122783, 5.39257E-06, 2.37158E-05, 4.5262E-05, 0.000199056, 0.000394233, 0.001733785, 0.00330895, 0.014552335, 1.77747E-07, 7.81708E-07, 1.4919E-06, 6.56118E-06, 1.29945E-05, 5.7148E-05, 0.000109068, 0.000479666, 2.30377E-06, 1.01317E-05, 1.93364E-05, 8.50391E-05, 0.000168421, 0.000740693, 0.001413621, 0.006216922, 1.18884E-06, 5.22838E-06, 9.97842E-06, 4.38838E-05, 8.69123E-05, 0.000382229, 0.000729489, 0.003208198, 1.54085E-05, 6.77647E-05, 0.00012933, 0.000568776, 0.001126466, 0.004954053, 0.009454869, 0.041581295, 2.176E-06, 9.56976E-06, 1.8264E-05, 8.03227E-05, 0.00015908, 0.000699613, 0.00133522, 0.005872125, 2.8203E-05, 0.000124033, 0.000236719, 0.001041059, 0.002061827, 0.00906765, 0.017305719, 0.076108317, 1.4554E-05, 6.40064E-05, 0.000122157, 0.000537231, 0.001063991, 0.004679296, 0.008930493, 0.039275157, 0.000188633, 0.000829584, 0.001583271, 0.006963024, 0.013790337, 0.060648122, 0.115747666, 0.509043294)
  
  
dt <- dcast(data, Biden~., sum, value.var = "Likelihood")
colnames(dt) <- c("Biden Electoral Votes", "Relative Likelihood")
dt$`Relative Likelihood` <- dt$`Relative Likelihood`
dt$category <- fifelse(dt$`Biden Electoral Votes` > 270, "Biden Win", "Trump Win")

ggplot(dt, aes(x=`Biden Electoral Votes`, y=`Relative Likelihood`, fill=category))+
  geom_col()+
  scale_fill_manual(values=c(
    "Trump Win"="#ee4444",
    "Biden Win"="#0077ee"
  ))+
  #geom_vline(xintercept = as.numeric(data[order(-density)][1,1]), linetype="dotted", color="#666666", size=1)+
  theme_bw()+
  theme(legend.position = "bottom")+
  scale_x_continuous(breaks=seq(0,400,5),expand = c(0,0), limits=c(min(dt$`Biden Electoral Votes`),max(dt$`Biden Electoral Votes`)))+
  scale_y_continuous(expand=c(0,0), limits=c(0,0.25))+
  theme(axis.line = element_line(color='black'),
        plot.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank())

date <- Sys.Date()
ggsave(paste0("electoral college ", date, ".png"))
