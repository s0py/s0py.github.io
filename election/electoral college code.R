library(data.table)
library(ggplot2)
library(ggdist)

data <- data.table(Trump = c(199, 208, 218, 205, 215, 224, 234, 195, 205, 214, 224, 211, 221, 230, 240, 199, 209, 218, 228, 215, 225, 234, 244, 205, 215, 224, 234, 221, 231, 240, 250, 219, 229, 238, 248, 235, 245, 254, 264, 225, 235, 244, 254, 241, 251, 260, 270, 229, 239, 248, 258, 245, 255, 264, 274, 235, 245, 254, 264, 251, 261, 270, 280, 205, 215, 224, 234, 221, 231, 240, 250, 211, 221, 230, 240, 227, 237, 246, 256, 215, 225, 234, 244, 231, 241, 250, 260, 221, 231, 240, 250, 237, 247, 256, 266, 235, 245, 254, 264, 251, 261, 270, 280, 241, 251, 260, 270, 257, 267, 276, 286, 245, 255, 264, 274, 261, 271, 280, 290, 251, 261, 270, 280, 267, 277, 286, 296, 210, 219, 229, 216, 226, 235, 245, 206, 216, 225, 235, 222, 232, 241, 251, 210, 220, 229, 239, 226, 236, 245, 255, 216, 226, 235, 245, 232, 242, 251, 261, 230, 240, 249, 259, 246, 256, 265, 275, 236, 246, 255, 265, 252, 262, 271, 281, 240, 250, 259, 269, 256, 266, 275, 285, 246, 256, 265, 275, 262, 272, 281, 291, 216, 226, 235, 245, 232, 242, 251, 261, 222, 232, 241, 251, 238, 248, 257, 267, 226, 236, 245, 255, 242, 252, 261, 271, 232, 242, 251, 261, 248, 258, 267, 277, 246, 256, 265, 275, 262, 272, 281, 291, 252, 262, 271, 281, 268, 278, 287, 297, 256, 266, 275, 285, 272, 282, 291, 301, 262, 272, 281, 291, 278, 288, 297, 307))
data$Biden <- 538 - data$Trump
data$category <- fifelse(data$Biden > 270, "Biden Win", "Trump Win")
data$Likelihood <- c(6.24294E-08, 7.01555E-07, 3.00509E-07, 4.79472E-07, 2.0538E-07, 2.30798E-06, 9.88614E-07, 2.51334E-06, 1.07658E-06, 1.20981E-05, 5.1822E-06, 8.26838E-06, 3.54173E-06, 3.98005E-05, 1.70484E-05, 2.5316E-08, 1.0844E-08, 1.2186E-07, 5.21984E-08, 8.32845E-08, 3.56746E-08, 4.00896E-07, 1.71723E-07, 4.36567E-07, 1.87002E-07, 2.10145E-06, 9.00149E-07, 1.43622E-06, 6.152E-07, 6.91336E-06, 2.96131E-06, 2.52257E-07, 1.08053E-07, 1.21426E-06, 5.20123E-07, 8.29876E-07, 3.55474E-07, 3.99467E-06, 1.7111E-06, 4.35011E-06, 1.86335E-06, 2.09396E-05, 8.9694E-06, 1.4311E-05, 6.13006E-06, 6.88871E-05, 2.95075E-05, 4.38171E-08, 1.87689E-08, 2.10917E-07, 9.03456E-08, 1.4415E-07, 6.1746E-08, 6.93875E-07, 2.97219E-07, 7.55615E-07, 3.23665E-07, 3.63721E-06, 1.55799E-06, 2.48582E-06, 1.06479E-06, 1.19657E-05, 5.12547E-06, 3.65706E-05, 1.56649E-05, 0.000176035, 7.54042E-05, 0.00012031, 5.15344E-05, 0.000579122, 0.000248065, 0.000630651, 0.000270137, 0.003035688, 0.001300326, 0.002074717, 0.000888698, 0.009986813, 0.004277816, 6.35233E-06, 2.721E-06, 3.05774E-05, 1.30977E-05, 2.08979E-05, 8.95154E-06, 0.000100594, 4.30889E-05, 0.000109544, 4.69229E-05, 0.0005273, 0.000225867, 0.000360379, 0.000154367, 0.001734712, 0.000743058, 6.32968E-05, 2.7113E-05, 0.000304684, 0.00013051, 0.000208234, 8.91962E-05, 0.00100235, 0.000429353, 0.001091537, 0.000467556, 0.005254199, 0.002250618, 0.003590941, 0.001538167, 0.017285274, 0.007404087, 1.09947E-05, 4.70953E-06, 5.29237E-05, 2.26697E-05, 3.61703E-05, 1.54934E-05, 0.000174108, 7.45788E-05, 0.0001896, 8.12146E-05, 0.000912656, 0.000390933, 0.000623747, 0.00026718, 0.003002457, 0.001286092, 7.53831E-07, 8.47123E-06, 3.62862E-06, 5.7896E-06, 2.47995E-06, 2.78687E-05, 1.19375E-05, 3.03484E-05, 1.29996E-05, 0.000146084, 6.25747E-05, 9.98402E-05, 4.27662E-05, 0.000480588, 0.000205858, 3.05689E-07, 1.30941E-07, 1.47146E-06, 6.30293E-07, 1.00565E-06, 4.30769E-07, 4.8408E-06, 2.07354E-06, 5.27152E-06, 2.25804E-06, 2.53749E-05, 1.08692E-05, 1.73423E-05, 7.4285E-06, 8.34783E-05, 3.57577E-05, 3.04599E-06, 1.30474E-06, 1.46621E-05, 6.28046E-06, 1.00207E-05, 4.29233E-06, 4.82354E-05, 2.06615E-05, 5.25273E-05, 2.24999E-05, 0.000252844, 0.000108305, 0.000172804, 7.40201E-05, 0.000831807, 0.000356302, 5.29089E-07, 2.26633E-07, 2.54681E-06, 1.09092E-06, 1.7406E-06, 7.45579E-07, 8.3785E-06, 3.5889E-06, 9.124E-06, 3.90823E-06, 4.39191E-05, 1.88126E-05, 3.00162E-05, 1.28573E-05, 0.000144485, 6.18897E-05, 0.000441588, 0.000189153, 0.002125617, 0.000910501, 0.001452736, 0.000622274, 0.006992859, 0.002995367, 0.00761507, 0.003261888, 0.036655733, 0.015701355, 0.025052071, 0.010730967, 0.120590102, 0.051654348, 7.67039E-05, 3.28559E-05, 0.00036922, 0.000158154, 0.000252341, 0.000108089, 0.001214662, 0.000520296, 0.00132274, 0.000566591, 0.006367111, 0.00272733, 0.004351552, 0.001863972, 0.020946535, 0.008972375, 0.000764304, 0.000327387, 0.003679039, 0.001575903, 0.00251441, 0.001077039, 0.012103309, 0.00518441, 0.013180238, 0.005645709, 0.063444105, 0.02717606, 0.043360372, 0.018573264, 0.208718541, 0.089403856, 0.00013276, 5.68672E-05, 0.00063905, 0.000273735, 0.000436754, 0.000187082, 0.002102348, 0.000900534, 0.002289411, 0.000980661, 0.011020259, 0.004720489, 0.007531709, 0.003226181, 0.036254469, 0.015529475)
  
  
dt <- dcast(data, Biden~., sum, value.var = "Likelihood")
colnames(dt) <- c("Biden Electoral Votes", "Relative Likelihood")
dt$`Relative Likelihood` <- dt$`Relative Likelihood`
dt$category <- fifelse(dt$`Biden Electoral Votes` > 270, "Biden Win", "Trump Win")

ggplot(dt, aes(x=`Biden Electoral Votes`, y=`Relative Likelihood`, fill=category))+
  geom_col()+
  scale_fill_manual(values=c(
    "Trump Win"="#ee4444",
    "Biden Win"="#0077ee"
  ))+
  #geom_vline(xintercept = as.numeric(data[order(-density)][1,1]), linetype="dotted", color="#666666", size=1)+
  theme_bw()+
  theme(legend.position = "bottom")+
  scale_x_continuous(breaks=seq(0,400,5),expand = c(0,0), limits=c(min(dt$`Biden Electoral Votes`),max(dt$`Biden Electoral Votes`)))+
  scale_y_continuous(expand=c(0,0), limits=c(0,0.25))+
  theme(axis.line = element_line(color='black'),
        plot.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank())

ggsave("electoral college 2023-11-15.png")


#ggplot(data, aes(x=Biden, fill=category, size=Likelihood))+
#  stat_dots(color="white")+
#  #geom_density()+
#  #geom_histogram(bins = 20, binwidth = 0.5)+
#  scale_fill_manual(values=c(
#    "Trump Win"="#ee4444",
#    "Biden Win"="#0077ee"
#  ))+
#  #geom_vline(xintercept = as.numeric(data[order(-density)][1,1]), linetype="dotted", color="#666666", size=1)+
#  theme_bw()+
#  xlab("Electoral Votes")+
#  ylab("Number of Ways it can Happen")+
#  theme(legend.position = "bottom")+
#  theme(axis.line = element_line(color='black'),
#        plot.background = element_blank(),
#        panel.grid.major = element_blank(),
#        panel.grid.minor = element_blank(),
#        panel.border = element_blank())+
#  labs(title="Electoral College Prediction", subtitles="As of 2023-11-11")
