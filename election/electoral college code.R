library(data.table)
library(ggplot2)
library(ggdist)

data <- data.table(Trump = c(199, 208, 218, 205, 215, 224, 234, 195, 205, 214, 224, 211, 221, 230, 240, 199, 209, 218, 228, 215, 225, 234, 244, 205, 215, 224, 234, 221, 231, 240, 250, 219, 229, 238, 248, 235, 245, 254, 264, 225, 235, 244, 254, 241, 251, 260, 270, 229, 239, 248, 258, 245, 255, 264, 274, 235, 245, 254, 264, 251, 261, 270, 280, 205, 215, 224, 234, 221, 231, 240, 250, 211, 221, 230, 240, 227, 237, 246, 256, 215, 225, 234, 244, 231, 241, 250, 260, 221, 231, 240, 250, 237, 247, 256, 266, 235, 245, 254, 264, 251, 261, 270, 280, 241, 251, 260, 270, 257, 267, 276, 286, 245, 255, 264, 274, 261, 271, 280, 290, 251, 261, 270, 280, 267, 277, 286, 296, 210, 219, 229, 216, 226, 235, 245, 206, 216, 225, 235, 222, 232, 241, 251, 210, 220, 229, 239, 226, 236, 245, 255, 216, 226, 235, 245, 232, 242, 251, 261, 230, 240, 249, 259, 246, 256, 265, 275, 236, 246, 255, 265, 252, 262, 271, 281, 240, 250, 259, 269, 256, 266, 275, 285, 246, 256, 265, 275, 262, 272, 281, 291, 216, 226, 235, 245, 232, 242, 251, 261, 222, 232, 241, 251, 238, 248, 257, 267, 226, 236, 245, 255, 242, 252, 261, 271, 232, 242, 251, 261, 248, 258, 267, 277, 246, 256, 265, 275, 262, 272, 281, 291, 252, 262, 271, 281, 268, 278, 287, 297, 256, 266, 275, 285, 272, 282, 291, 301, 262, 272, 281, 291, 278, 288, 297, 307))
data$Biden <- 538 - data$Trump
data$category <- fifelse(data$Biden > 270, "Biden Win", "Trump Win")
data$Likelihood <- c(1.78456E-11, 3.83056E-11, 2.04037E-10, 5.44331E-10, 2.89941E-09, 6.22361E-09, 3.31504E-08, 6.82334E-11, 3.63449E-10, 7.80146E-10, 4.15549E-09, 1.1086E-08, 5.90505E-08, 1.26752E-07, 6.75153E-07, 2.89775E-11, 1.54351E-10, 3.31314E-10, 1.76477E-09, 4.70805E-09, 2.50777E-08, 5.38294E-08, 2.86726E-07, 5.90166E-10, 3.14356E-09, 6.74766E-09, 3.59418E-08, 9.58857E-08, 5.10741E-07, 1.09631E-06, 5.83955E-06, 6.37672E-11, 3.3966E-10, 7.29082E-10, 3.8835E-09, 1.03604E-08, 5.51854E-08, 1.18456E-07, 6.30961E-07, 1.2987E-09, 6.91763E-09, 1.48487E-08, 7.90927E-08, 2.11004E-07, 1.12392E-06, 2.41251E-06, 1.28504E-05, 5.51538E-10, 2.9378E-09, 6.306E-09, 3.35893E-08, 8.96096E-08, 4.77311E-07, 1.02455E-06, 5.45733E-06, 1.12328E-08, 5.98322E-08, 1.2843E-07, 6.84091E-07, 1.82502E-06, 9.72108E-06, 2.08663E-05, 0.000111146, 2.23645E-10, 1.19126E-09, 2.55704E-09, 1.36202E-08, 3.63361E-08, 1.93547E-07, 4.15448E-07, 2.21291E-06, 4.55483E-09, 2.42616E-08, 5.20776E-08, 2.77394E-07, 7.40033E-07, 3.94183E-06, 8.46116E-06, 4.50689E-05, 1.93436E-09, 1.03035E-08, 2.21165E-08, 1.17805E-07, 3.14279E-07, 1.67403E-06, 3.59331E-06, 1.914E-05, 3.93958E-08, 2.09844E-07, 4.50431E-07, 2.39925E-06, 6.40072E-06, 3.40938E-05, 7.31826E-05, 0.000389812, 4.2567E-09, 2.26736E-08, 4.86689E-08, 2.59238E-07, 6.91595E-07, 3.68382E-06, 7.90734E-06, 4.2119E-05, 8.66933E-08, 4.61777E-07, 9.91207E-07, 5.27972E-06, 1.40853E-05, 7.5026E-05, 0.000161044, 0.000857809, 3.68172E-08, 1.96109E-07, 4.20948E-07, 2.24221E-06, 5.98177E-06, 3.18623E-05, 6.83925E-05, 0.000364297, 7.49831E-07, 3.99402E-06, 8.57318E-06, 4.56656E-05, 0.000121827, 0.000648918, 0.001392904, 0.007419391, 1.4624E-09, 3.13905E-09, 1.67204E-08, 4.46066E-08, 2.376E-07, 5.10009E-07, 2.7166E-06, 5.59156E-09, 2.97838E-08, 6.3931E-08, 3.40532E-07, 9.08473E-07, 4.83904E-06, 1.0387E-05, 5.53271E-05, 2.37464E-09, 1.26487E-08, 2.71504E-08, 1.44618E-07, 3.85813E-07, 2.05506E-06, 4.41119E-06, 2.34965E-05, 4.83627E-08, 2.57607E-07, 5.52954E-07, 2.94534E-06, 7.8576E-06, 4.1854E-05, 8.98397E-05, 0.000478537, 5.22557E-09, 2.78343E-08, 5.97464E-08, 3.18243E-07, 8.4901E-07, 4.5223E-06, 9.70714E-06, 5.17057E-05, 1.06426E-07, 5.66883E-07, 1.21682E-06, 6.48145E-06, 1.72912E-05, 9.21028E-05, 0.000197699, 0.001053056, 4.51971E-08, 2.40745E-07, 5.16761E-07, 2.75256E-06, 7.34328E-06, 3.91145E-05, 8.39593E-05, 0.000447215, 9.205E-07, 4.9031E-06, 1.05245E-05, 5.60596E-05, 0.000149556, 0.000796618, 0.001709944, 0.009108126, 1.83271E-08, 9.76207E-08, 2.09543E-07, 1.11615E-06, 2.97765E-06, 1.58607E-05, 3.4045E-05, 0.000181343, 3.73257E-07, 1.98818E-06, 4.26763E-06, 2.27318E-05, 6.06439E-05, 0.000323024, 0.000693371, 0.003693286, 1.58516E-07, 8.44344E-07, 1.81239E-06, 9.6538E-06, 2.57544E-05, 0.000137183, 0.000294463, 0.001568475, 3.22839E-06, 1.71962E-05, 3.69117E-05, 0.000196613, 0.000524523, 0.002793906, 0.005997131, 0.031944095, 3.48826E-07, 1.85804E-06, 3.98829E-06, 2.12439E-05, 5.66745E-05, 0.00030188, 0.000647987, 0.003451545, 7.1043E-06, 3.78415E-05, 8.12269E-05, 0.00043266, 0.001154252, 0.006148197, 0.013197128, 0.070295329, 3.01707E-06, 1.60706E-05, 3.44957E-05, 0.000183743, 0.000490191, 0.002611034, 0.005604594, 0.02985322, 6.14468E-05, 0.0003273, 0.000702551, 0.003742181, 0.009983397, 0.05317719, 0.114145044, 0.60800073)
  
  
dt <- dcast(data, Biden~., sum, value.var = "Likelihood")
colnames(dt) <- c("Biden Electoral Votes", "Relative Likelihood")
dt$`Relative Likelihood` <- dt$`Relative Likelihood`
dt$category <- fifelse(dt$`Biden Electoral Votes` > 270, "Biden Win", "Trump Win")

ggplot(dt, aes(x=`Biden Electoral Votes`, y=`Relative Likelihood`, fill=category))+
  geom_col()+
  scale_fill_manual(values=c(
    "Trump Win"="#ee4444",
    "Biden Win"="#0077ee"
  ))+
  #geom_vline(xintercept = as.numeric(data[order(-density)][1,1]), linetype="dotted", color="#666666", size=1)+
  theme_bw()+
  theme(legend.position = "bottom")+
  scale_x_continuous(breaks=seq(0,400,5),expand = c(0,0), limits=c(min(dt$`Biden Electoral Votes`),max(dt$`Biden Electoral Votes`)))+
  scale_y_continuous(expand=c(0,0), limits=c(0,0.25))+
  theme(axis.line = element_line(color='black'),
        plot.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank())

date <- Sys.Date()
ggsave(paste0("electoral college ", date, ".png"))
