library(data.table)
library(ggplot2)
library(ggdist)

data <- data.table(Trump = c(199, 208, 218, 205, 215, 224, 234, 195, 205, 214, 224, 211, 221, 230, 240, 199, 209, 218, 228, 215, 225, 234, 244, 205, 215, 224, 234, 221, 231, 240, 250, 219, 229, 238, 248, 235, 245, 254, 264, 225, 235, 244, 254, 241, 251, 260, 270, 229, 239, 248, 258, 245, 255, 264, 274, 235, 245, 254, 264, 251, 261, 270, 280, 205, 215, 224, 234, 221, 231, 240, 250, 211, 221, 230, 240, 227, 237, 246, 256, 215, 225, 234, 244, 231, 241, 250, 260, 221, 231, 240, 250, 237, 247, 256, 266, 235, 245, 254, 264, 251, 261, 270, 280, 241, 251, 260, 270, 257, 267, 276, 286, 245, 255, 264, 274, 261, 271, 280, 290, 251, 261, 270, 280, 267, 277, 286, 296, 210, 219, 229, 216, 226, 235, 245, 206, 216, 225, 235, 222, 232, 241, 251, 210, 220, 229, 239, 226, 236, 245, 255, 216, 226, 235, 245, 232, 242, 251, 261, 230, 240, 249, 259, 246, 256, 265, 275, 236, 246, 255, 265, 252, 262, 271, 281, 240, 250, 259, 269, 256, 266, 275, 285, 246, 256, 265, 275, 262, 272, 281, 291, 216, 226, 235, 245, 232, 242, 251, 261, 222, 232, 241, 251, 238, 248, 257, 267, 226, 236, 245, 255, 242, 252, 261, 271, 232, 242, 251, 261, 248, 258, 267, 277, 246, 256, 265, 275, 262, 272, 281, 291, 252, 262, 271, 281, 268, 278, 287, 297, 256, 266, 275, 285, 272, 282, 291, 301, 262, 272, 281, 291, 278, 288, 297, 307))
data$Biden <- 538 - data$Trump
data$category <- fifelse(data$Biden > 270, "Biden Win", "Trump Win")
data$Likelihood <- c(1.03573E-07, 1.07944E-06, 4.74353E-07, 7.4368E-07, 3.26805E-07, 3.40596E-06, 1.49672E-06, 3.66796E-06, 1.61186E-06, 1.67988E-05, 7.38211E-06, 1.15735E-05, 5.0859E-06, 5.30053E-05, 2.32928E-05, 4.33179E-08, 1.90357E-08, 1.98391E-07, 8.71813E-08, 1.36681E-07, 6.00634E-08, 6.25982E-07, 2.75083E-07, 6.74135E-07, 2.96243E-07, 3.08745E-06, 1.35676E-06, 2.1271E-06, 9.34737E-07, 9.74185E-06, 4.28098E-06, 3.98328E-07, 1.75042E-07, 1.82429E-06, 8.01672E-07, 1.25684E-06, 5.52311E-07, 5.75619E-06, 2.52952E-06, 6.19898E-06, 2.72409E-06, 2.83906E-05, 1.2476E-05, 1.95596E-05, 8.59534E-06, 8.95808E-05, 3.93656E-05, 7.32087E-08, 3.2171E-08, 3.35287E-07, 1.47339E-07, 2.30995E-07, 1.01509E-07, 1.05793E-06, 4.649E-07, 1.13931E-06, 5.00661E-07, 5.2179E-06, 2.29297E-06, 3.59487E-06, 1.57974E-06, 1.64641E-05, 7.235E-06, 4.67717E-05, 2.05535E-05, 0.000214209, 9.41323E-05, 0.000147579, 6.48524E-05, 0.000675892, 0.000297016, 0.000727884, 0.000319863, 0.003333621, 0.001464935, 0.002296694, 0.001009265, 0.010518578, 0.004622309, 8.59617E-06, 3.77752E-06, 3.93694E-05, 1.73006E-05, 2.71235E-05, 1.19192E-05, 0.000124222, 5.45885E-05, 0.000133778, 5.87877E-05, 0.000612686, 0.00026924, 0.00042211, 0.000185493, 0.00193321, 0.000849534, 7.90457E-05, 3.4736E-05, 0.00036202, 0.000159087, 0.000249413, 0.000109603, 0.001142281, 0.000501967, 0.001230149, 0.00054058, 0.005633932, 0.002475788, 0.00388149, 0.001705691, 0.017776749, 0.007811857, 1.45278E-05, 6.38414E-06, 6.65356E-05, 2.92386E-05, 4.58396E-05, 2.01439E-05, 0.00020994, 9.22565E-05, 0.000226089, 9.93531E-05, 0.00103546, 0.000455025, 0.000713379, 0.000313489, 0.003267189, 0.001435741, 1.14813E-06, 1.19658E-05, 5.2583E-06, 8.24385E-06, 3.6227E-06, 3.77558E-05, 1.65915E-05, 4.06601E-05, 1.78678E-05, 0.000186218, 8.18323E-05, 0.000128295, 5.63783E-05, 0.000587575, 0.000258205, 4.80188E-07, 2.11015E-07, 2.1992E-06, 9.66423E-07, 1.51514E-06, 6.65816E-07, 6.93915E-06, 3.04935E-06, 7.47293E-06, 3.28392E-06, 3.42251E-05, 1.504E-05, 2.35793E-05, 1.03618E-05, 0.00010799, 4.74556E-05, 4.41555E-06, 1.94038E-06, 2.02227E-05, 8.8867E-06, 1.39324E-05, 6.12248E-06, 6.38086E-05, 2.80402E-05, 6.8717E-05, 3.01972E-05, 0.000314715, 0.000138299, 0.000216823, 9.52811E-05, 0.000993022, 0.000436376, 8.11534E-07, 3.56622E-07, 3.71673E-06, 1.63329E-06, 2.56063E-06, 1.12525E-06, 1.17274E-05, 5.15351E-06, 1.26295E-05, 5.54994E-06, 5.78416E-05, 2.5418E-05, 3.98499E-05, 1.75117E-05, 0.000182507, 8.02015E-05, 0.000518474, 0.000227839, 0.002374547, 0.001043477, 0.001635942, 0.000718902, 0.007492411, 0.003292483, 0.008068754, 0.003545752, 0.0369539, 0.01623911, 0.025459346, 0.011187915, 0.116600672, 0.051239277, 9.52904E-05, 4.18746E-05, 0.000436418, 0.000191781, 0.00030067, 0.000132127, 0.00137703, 0.000605126, 0.001482956, 0.000651674, 0.006791758, 0.002984586, 0.004679173, 0.002056227, 0.021430039, 0.009417267, 0.000876238, 0.000385056, 0.004013065, 0.001763511, 0.002764796, 0.001214969, 0.012662426, 0.005564407, 0.013636464, 0.00599244, 0.062453328, 0.027444639, 0.043027146, 0.018907951, 0.197059037, 0.086596093, 0.000161044, 7.07695E-05, 0.000737561, 0.000324116, 0.000508142, 0.000223299, 0.002327227, 0.001022682, 0.002506246, 0.001101351, 0.011478298, 0.005044051, 0.00790796, 0.003475093, 0.036217483, 0.015915497)
  
  
dt <- dcast(data, Biden~., sum, value.var = "Likelihood")
colnames(dt) <- c("Biden Electoral Votes", "Relative Likelihood")
dt$`Relative Likelihood` <- dt$`Relative Likelihood`
dt$category <- fifelse(dt$`Biden Electoral Votes` > 270, "Biden Win", "Trump Win")

ggplot(dt, aes(x=`Biden Electoral Votes`, y=`Relative Likelihood`, fill=category))+
  geom_col()+
  scale_fill_manual(values=c(
    "Trump Win"="#ee4444",
    "Biden Win"="#0077ee"
  ))+
  #geom_vline(xintercept = as.numeric(data[order(-density)][1,1]), linetype="dotted", color="#666666", size=1)+
  theme_bw()+
  theme(legend.position = "bottom")+
  scale_x_continuous(breaks=seq(0,400,5),expand = c(0,0), limits=c(min(dt$`Biden Electoral Votes`),max(dt$`Biden Electoral Votes`)))+
  scale_y_continuous(expand=c(0,0), limits=c(0,0.25))+
  theme(axis.line = element_line(color='black'),
        plot.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank())

ggsave("electoral college 2023-11-16.png")
